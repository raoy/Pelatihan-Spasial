<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Modul 3 Geographically Weighted Regression (GWR) | Modul Praktikum - Pelatihan Analisis Spasial</title>
  <meta name="description" content="Modul 3 Geographically Weighted Regression (GWR) | Modul Praktikum - Pelatihan Analisis Spasial" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Modul 3 Geographically Weighted Regression (GWR) | Modul Praktikum - Pelatihan Analisis Spasial" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Modul 3 Geographically Weighted Regression (GWR) | Modul Praktikum - Pelatihan Analisis Spasial" />
  
  
  

<meta name="author" content="Anik Djuraidah, Rahma Anisa, Gerry Alfa Dito" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pemodelan-dependensi-spasial.html"/>
<link rel="next" href="applications.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="pengantar-analisis-spasial-dengan-r-software.html"><a href="pengantar-analisis-spasial-dengan-r-software.html"><i class="fa fa-check"></i><b>1</b> Pengantar Analisis Spasial dengan R Software</a>
<ul>
<li class="chapter" data-level="1.1" data-path="pengantar-analisis-spasial-dengan-r-software.html"><a href="pengantar-analisis-spasial-dengan-r-software.html#pengenalan-r-software"><i class="fa fa-check"></i><b>1.1</b> Pengenalan R Software</a></li>
<li class="chapter" data-level="1.2" data-path="pengantar-analisis-spasial-dengan-r-software.html"><a href="pengantar-analisis-spasial-dengan-r-software.html#pengenalan-data-spasial"><i class="fa fa-check"></i><b>1.2</b> Pengenalan Data Spasial</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="pengantar-analisis-spasial-dengan-r-software.html"><a href="pengantar-analisis-spasial-dengan-r-software.html#struktur-data-spasial"><i class="fa fa-check"></i><b>1.2.1</b> Struktur Data Spasial</a></li>
<li class="chapter" data-level="1.2.2" data-path="pengantar-analisis-spasial-dengan-r-software.html"><a href="pengantar-analisis-spasial-dengan-r-software.html#ilustrasi-data-cholera"><i class="fa fa-check"></i><b>1.2.2</b> Ilustrasi Data Cholera</a></li>
<li class="chapter" data-level="1.2.3" data-path="pengantar-analisis-spasial-dengan-r-software.html"><a href="pengantar-analisis-spasial-dengan-r-software.html#visualisasi-data-cholera"><i class="fa fa-check"></i><b>1.2.3</b> Visualisasi Data Cholera</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="pengantar-analisis-spasial-dengan-r-software.html"><a href="pengantar-analisis-spasial-dengan-r-software.html#tipe-data-spasial"><i class="fa fa-check"></i><b>1.3</b> Tipe Data Spasial</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="pengantar-analisis-spasial-dengan-r-software.html"><a href="pengantar-analisis-spasial-dengan-r-software.html#tipe-data-titik"><i class="fa fa-check"></i><b>1.3.1</b> Tipe Data titik</a></li>
<li class="chapter" data-level="1.3.2" data-path="pengantar-analisis-spasial-dengan-r-software.html"><a href="pengantar-analisis-spasial-dengan-r-software.html#tipe-data-kontinu"><i class="fa fa-check"></i><b>1.3.2</b> Tipe Data Kontinu</a></li>
<li class="chapter" data-level="1.3.3" data-path="pengantar-analisis-spasial-dengan-r-software.html"><a href="pengantar-analisis-spasial-dengan-r-software.html#tipe-data-area"><i class="fa fa-check"></i><b>1.3.3</b> Tipe Data Area</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="pengantar-analisis-spasial-dengan-r-software.html"><a href="pengantar-analisis-spasial-dengan-r-software.html#matriks-bobot-dan-autokorelasi-spasial"><i class="fa fa-check"></i><b>1.4</b> Matriks Bobot dan Autokorelasi Spasial</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="pengantar-analisis-spasial-dengan-r-software.html"><a href="pengantar-analisis-spasial-dengan-r-software.html#kriteria-kebertetanggaan"><i class="fa fa-check"></i><b>1.4.1</b> Kriteria Kebertetanggaan</a></li>
<li class="chapter" data-level="1.4.2" data-path="pengantar-analisis-spasial-dengan-r-software.html"><a href="pengantar-analisis-spasial-dengan-r-software.html#matriks-pembobot-spasial"><i class="fa fa-check"></i><b>1.4.2</b> Matriks Pembobot Spasial</a></li>
<li class="chapter" data-level="1.4.3" data-path="pengantar-analisis-spasial-dengan-r-software.html"><a href="pengantar-analisis-spasial-dengan-r-software.html#autokorelasi-spasial"><i class="fa fa-check"></i><b>1.4.3</b> Autokorelasi Spasial</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="pengantar-analisis-spasial-dengan-r-software.html"><a href="pengantar-analisis-spasial-dengan-r-software.html#sumber-pustaka"><i class="fa fa-check"></i><b>1.5</b> Sumber Pustaka</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html"><i class="fa fa-check"></i><b>2</b> Pemodelan Dependensi Spasial</a>
<ul>
<li class="chapter" data-level="2.1" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#model-spasial-global"><i class="fa fa-check"></i><b>2.1</b> Model Spasial Global</a></li>
<li class="chapter" data-level="2.2" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#eksplorasi-data"><i class="fa fa-check"></i><b>2.2</b> Eksplorasi Data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#identifikasi-autokorelasi-pada-data"><i class="fa fa-check"></i><b>2.2.1</b> Identifikasi Autokorelasi pada Data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#pemodelan-regresi-klasik"><i class="fa fa-check"></i><b>2.3</b> Pemodelan Regresi Klasik</a></li>
<li class="chapter" data-level="2.4" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#diagnostik-model"><i class="fa fa-check"></i><b>2.4</b> Diagnostik Model</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#kenormalan-sisaan"><i class="fa fa-check"></i><b>2.4.1</b> Kenormalan Sisaan</a></li>
<li class="chapter" data-level="2.4.2" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#kehomogenan-ragam-sisaan"><i class="fa fa-check"></i><b>2.4.2</b> Kehomogenan Ragam Sisaan</a></li>
<li class="chapter" data-level="2.4.3" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#kebebasan-sisaan"><i class="fa fa-check"></i><b>2.4.3</b> Kebebasan Sisaan</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#uji-lagrange-multiplier"><i class="fa fa-check"></i><b>2.5</b> Uji Lagrange Multiplier</a></li>
<li class="chapter" data-level="2.6" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#pemodelan-regresi-spasial"><i class="fa fa-check"></i><b>2.6</b> Pemodelan Regresi Spasial</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#model-sem"><i class="fa fa-check"></i><b>2.6.1</b> Model SEM</a></li>
<li class="chapter" data-level="2.6.2" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#model-sar"><i class="fa fa-check"></i><b>2.6.2</b> Model SAR</a></li>
<li class="chapter" data-level="2.6.3" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#model-gsmsarma"><i class="fa fa-check"></i><b>2.6.3</b> Model GSM/SARMA</a></li>
<li class="chapter" data-level="2.6.4" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#penentuan-model-terbaik"><i class="fa fa-check"></i><b>2.6.4</b> Penentuan Model Terbaik</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#efek-marginal"><i class="fa fa-check"></i><b>2.7</b> Efek Marginal</a></li>
<li class="chapter" data-level="2.8" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#latihan"><i class="fa fa-check"></i><b>2.8</b> Latihan</a></li>
<li class="chapter" data-level="2.9" data-path="pemodelan-dependensi-spasial.html"><a href="pemodelan-dependensi-spasial.html#sumber-pustaka-1"><i class="fa fa-check"></i><b>2.9</b> Sumber Pustaka</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="geographically-weighted-regression-gwr.html"><a href="geographically-weighted-regression-gwr.html"><i class="fa fa-check"></i><b>3</b> Geographically Weighted Regression (GWR)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="geographically-weighted-regression-gwr.html"><a href="geographically-weighted-regression-gwr.html#eksplorasi-data-1"><i class="fa fa-check"></i><b>3.1</b> Eksplorasi Data</a></li>
<li class="chapter" data-level="3.2" data-path="geographically-weighted-regression-gwr.html"><a href="geographically-weighted-regression-gwr.html#basic-gwr"><i class="fa fa-check"></i><b>3.2</b> Basic GWR</a></li>
<li class="chapter" data-level="3.3" data-path="geographically-weighted-regression-gwr.html"><a href="geographically-weighted-regression-gwr.html#menentukan-bandwidth-optimal"><i class="fa fa-check"></i><b>3.3</b> Menentukan Bandwidth Optimal</a></li>
<li class="chapter" data-level="3.4" data-path="geographically-weighted-regression-gwr.html"><a href="geographically-weighted-regression-gwr.html#menentukan-model-terbaik"><i class="fa fa-check"></i><b>3.4</b> Menentukan Model Terbaik</a></li>
<li class="chapter" data-level="3.5" data-path="geographically-weighted-regression-gwr.html"><a href="geographically-weighted-regression-gwr.html#menginterpretasikan-hasil-pemodelan-gwr"><i class="fa fa-check"></i><b>3.5</b> Menginterpretasikan Hasil Pemodelan GWR</a></li>
<li class="chapter" data-level="3.6" data-path="geographically-weighted-regression-gwr.html"><a href="geographically-weighted-regression-gwr.html#sumber-pustaka-2"><i class="fa fa-check"></i><b>3.6</b> Sumber Pustaka</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>4</b> Applications</a>
<ul>
<li class="chapter" data-level="4.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>4.1</b> Example one</a></li>
<li class="chapter" data-level="4.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>4.2</b> Example two</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modul Praktikum - Pelatihan Analisis Spasial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="geographically-weighted-regression-gwr" class="section level1" number="3">
<h1><span class="header-section-number">Modul 3</span> Geographically Weighted Regression (GWR)</h1>
<p>Suatu pemodelan dapat bersifat global maupun lokal. Regresi linier klasik merupakan salah satu model global. Dikatakan global karena terdapat satu model yang berlaku umum untuk semua pengamatan.</p>
<p>Suatu model lokal bersifat lebih fleksibel, yang dalam konteks spasial, artinya setiap daerah/lokasi dapat memiliki model masing-masing.</p>
<p>Geographically Weighted Regression (GWR) merupakan salah satu model yang bersifat lokal. Beberapa keuntungan dengen menggunakan model ini, diantaranya adalah kita dapat:</p>
<ul>
<li><p>menduga galat baku lokal</p></li>
<li><p>menghitung ukuran leverage lokal</p></li>
<li><p>melakukan pengujian terhadap signifikansi keragaman spasial pada penduga parameter lokal</p></li>
<li><p>menguji apakah model lokal lebih baik daripada model global</p></li>
</ul>
<p>Terdapat salah satu <em>stand-alone software</em> untuk melakukan GWR, yaitu software GWR yang dapat diakses melalui <a href="http://ncg.nuim.ie/ncg/GWR/" class="uri">http://ncg.nuim.ie/ncg/GWR/</a>. Selain itu, pada R software, terdapat beberapa package yang dapat digunakan untuk membangun model GWR, yaitu:</p>
<ul>
<li><p>GWmodel</p></li>
<li><p>spgwr</p></li>
<li><p>gwrr</p></li>
</ul>
<p>Pada modul ini akan dibahas pemodelan GWR menggunakan package <code>spgwr</code>.</p>
<div id="eksplorasi-data-1" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Eksplorasi Data</h2>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="geographically-weighted-regression-gwr.html#cb122-1" aria-hidden="true"></a><span class="kw">library</span>(rgdal)</span>
<span id="cb122-2"><a href="geographically-weighted-regression-gwr.html#cb122-2" aria-hidden="true"></a>petajawa=<span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="st">&quot;Jawamap&quot;</span>, <span class="dt">layer=</span><span class="st">&quot;jawa&quot;</span>)</span></code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;D:\Research (eksternal dept)\pelatihan spasial (adj)\modul\Jawamap&quot;, layer: &quot;jawa&quot;
## with 119 features
## It has 5 fields</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="geographically-weighted-regression-gwr.html#cb124-1" aria-hidden="true"></a>datajawa=<span class="kw">read.csv</span>(<span class="st">&quot;Pulau Jawa.csv&quot;</span>, <span class="dt">header=</span>T, <span class="dt">sep=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb124-2"><a href="geographically-weighted-regression-gwr.html#cb124-2" aria-hidden="true"></a>petajawa<span class="op">$</span>Kemiskinan&lt;-<span class="st"> </span>datajawa<span class="op">$</span>Kemiskinan</span></code></pre></div>
<p>Plot berikut ini dapat dimanfaatkan untuk mengeksplorasi hubungan antar peubah.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="geographically-weighted-regression-gwr.html#cb125-1" aria-hidden="true"></a>corr&lt;-<span class="kw">cor</span>(datajawa[,<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)])</span>
<span id="cb125-2"><a href="geographically-weighted-regression-gwr.html#cb125-2" aria-hidden="true"></a>corrplot<span class="op">::</span><span class="kw">corrplot</span>(corr, <span class="dt">is.corr=</span>T)</span></code></pre></div>
<p><img src="modul_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<p>Sebagai ilustrasi, peubah rata-rata lama sekolah akan digunakan untuk memodelkan kemiskinan di pulau Jawa. Sebagai langkah awal, kita akan terlebih dulu memodelkannya menggunakan regresi linear.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="geographically-weighted-regression-gwr.html#cb126-1" aria-hidden="true"></a>fit.lm&lt;-<span class="kw">lm</span>(Kemiskinan<span class="op">~</span>Rata.Rata.Lama.Sekolah, <span class="dt">data=</span>datajawa)</span>
<span id="cb126-2"><a href="geographically-weighted-regression-gwr.html#cb126-2" aria-hidden="true"></a><span class="kw">summary</span>(fit.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Kemiskinan ~ Rata.Rata.Lama.Sekolah, data = datajawa)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.0384 -1.9865 -0.3389  1.6722  9.7042 
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)             24.7340     1.3417   18.44   &lt;2e-16 ***
## Rata.Rata.Lama.Sekolah  -1.8657     0.1624  -11.49   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.898 on 117 degrees of freedom
## Multiple R-squared:  0.5302, Adjusted R-squared:  0.5262 
## F-statistic:   132 on 1 and 117 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Selanjutnya, diagnostik model dilakukan untuk memeriksa pemenuhan asumsi pada model regresi linear.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="geographically-weighted-regression-gwr.html#cb128-1" aria-hidden="true"></a>err.lm&lt;-<span class="kw">residuals</span>(fit.lm)</span>
<span id="cb128-2"><a href="geographically-weighted-regression-gwr.html#cb128-2" aria-hidden="true"></a><span class="kw">shapiro.test</span>(err.lm)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  err.lm
## W = 0.98029, p-value = 0.07818</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="geographically-weighted-regression-gwr.html#cb130-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb130-2"><a href="geographically-weighted-regression-gwr.html#cb130-2" aria-hidden="true"></a><span class="kw">hist</span>(err.lm)</span>
<span id="cb130-3"><a href="geographically-weighted-regression-gwr.html#cb130-3" aria-hidden="true"></a>car<span class="op">::</span><span class="kw">qqPlot</span>(<span class="kw">residuals</span>(fit.lm))</span></code></pre></div>
<p><img src="modul_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<pre><code>## [1]  69 115</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="geographically-weighted-regression-gwr.html#cb132-1" aria-hidden="true"></a><span class="kw">plot</span>(fit.lm,<span class="dt">which=</span><span class="dv">1</span>)</span>
<span id="cb132-2"><a href="geographically-weighted-regression-gwr.html#cb132-2" aria-hidden="true"></a>lmtest<span class="op">::</span><span class="kw">bptest</span>(fit.lm)</span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  fit.lm
## BP = 4.7982, df = 1, p-value = 0.02849</code></pre>
<p><img src="modul_files/figure-html/unnamed-chunk-58-2.png" width="672" /></p>
<p>Terlihat pada output di atas bahwa sisaan model cenderung memiliki ragam yang tidak konstan. Selanjutnya juga akan diperiksa kebebasan sisaan menggunakan uji moran.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="geographically-weighted-regression-gwr.html#cb134-1" aria-hidden="true"></a><span class="kw">library</span>(spdep)</span>
<span id="cb134-2"><a href="geographically-weighted-regression-gwr.html#cb134-2" aria-hidden="true"></a>w&lt;-<span class="kw">poly2nb</span>(petajawa)</span>
<span id="cb134-3"><a href="geographically-weighted-regression-gwr.html#cb134-3" aria-hidden="true"></a>ww&lt;-<span class="kw">nb2listw</span>(w, <span class="dt">zero.policy=</span>T)</span>
<span id="cb134-4"><a href="geographically-weighted-regression-gwr.html#cb134-4" aria-hidden="true"></a></span>
<span id="cb134-5"><a href="geographically-weighted-regression-gwr.html#cb134-5" aria-hidden="true"></a><span class="kw">lm.morantest</span>(fit.lm, ww, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>, <span class="dt">zero.policy =</span> T)</span></code></pre></div>
<pre><code>## 
##  Global Moran I for regression residuals
## 
## data:  
## model: lm(formula = Kemiskinan ~ Rata.Rata.Lama.Sekolah, data =
## datajawa)
## weights: ww
## 
## Moran I statistic standard deviate = 5.9602, p-value = 2.519e-09
## alternative hypothesis: two.sided
## sample estimates:
## Observed Moran I      Expectation         Variance 
##       0.38842759      -0.01284003       0.00453256</code></pre>
<p>Terlihat pada output bahwa terdapat autokorelasi spasial pada sisaan model regresi linier. Dengan mempertimbangkan bahwa sisaan model memiliki ragam yang tidak homogen, serta memiliki autokorelasi spasial, kita selanjutnya dapat mencoba memodelkannya dengan model regresi terboboti geografis atau GWR. Namun pada modul pembelajaran ini, kami akan perlihatkan pula bahwa pada pemodelan regresi spasial pun ternyata tetap menghasilkan sisaan dengan ragam yang heterogen.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="geographically-weighted-regression-gwr.html#cb136-1" aria-hidden="true"></a>LM&lt;-<span class="kw">lm.LMtests</span>(fit.lm, ww,<span class="dt">test=</span><span class="kw">c</span>(<span class="st">&quot;LMerr&quot;</span>, <span class="st">&quot;LMlag&quot;</span>,<span class="st">&quot;RLMerr&quot;</span>,<span class="st">&quot;RLMlag&quot;</span>,<span class="st">&quot;SARMA&quot;</span>), <span class="dt">zero.policy=</span>T)</span>
<span id="cb136-2"><a href="geographically-weighted-regression-gwr.html#cb136-2" aria-hidden="true"></a><span class="kw">summary</span>(LM)</span></code></pre></div>
<pre><code>##  Lagrange multiplier diagnostics for spatial dependence
## data:  
## model: lm(formula = Kemiskinan ~ Rata.Rata.Lama.Sekolah, data =
## datajawa)
## weights: ww
##  
##         statistic parameter   p.value    
## LMerr  32.3011683         1 1.320e-08 ***
## LMlag  18.2380122         1 1.949e-05 ***
## RLMerr 14.0653693         1 0.0001766 ***
## RLMlag  0.0022132         1 0.9624773    
## SARMA  32.3033815         2 9.670e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="geographically-weighted-regression-gwr.html#cb138-1" aria-hidden="true"></a><span class="kw">library</span>(spatialreg)</span>
<span id="cb138-2"><a href="geographically-weighted-regression-gwr.html#cb138-2" aria-hidden="true"></a>sem&lt;-<span class="kw">errorsarlm</span>(Kemiskinan<span class="op">~</span>Rata.Rata.Lama.Sekolah,<span class="dt">data=</span>datajawa,ww, <span class="dt">zero.policy=</span>T)</span>
<span id="cb138-3"><a href="geographically-weighted-regression-gwr.html#cb138-3" aria-hidden="true"></a>sar&lt;-<span class="kw">lagsarlm</span>(Kemiskinan<span class="op">~</span>Rata.Rata.Lama.Sekolah,<span class="dt">data=</span>datajawa,ww, <span class="dt">zero.policy=</span>T)</span>
<span id="cb138-4"><a href="geographically-weighted-regression-gwr.html#cb138-4" aria-hidden="true"></a>gsm&lt;-<span class="kw">sacsarlm</span>(Kemiskinan<span class="op">~</span>Rata.Rata.Lama.Sekolah,<span class="dt">data=</span>datajawa,ww, <span class="dt">zero.policy=</span>T)</span>
<span id="cb138-5"><a href="geographically-weighted-regression-gwr.html#cb138-5" aria-hidden="true"></a></span>
<span id="cb138-6"><a href="geographically-weighted-regression-gwr.html#cb138-6" aria-hidden="true"></a><span class="kw">bptest.sarlm</span>(sem)</span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  
## BP = 5.6364, df = 1, p-value = 0.01759</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="geographically-weighted-regression-gwr.html#cb140-1" aria-hidden="true"></a><span class="kw">bptest.sarlm</span>(sar)</span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  
## BP = 4.0536, df = 1, p-value = 0.04408</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="geographically-weighted-regression-gwr.html#cb142-1" aria-hidden="true"></a><span class="kw">bptest.sarlm</span>(gsm)</span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  
## BP = 3.8557, df = 1, p-value = 0.04958</code></pre>
</div>
<div id="basic-gwr" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Basic GWR</h2>
<p>Kita dapat menggunakan fungsi <code>gwr</code> pada package <code>spgwr</code> untuk menyusun model GWR pada R software, seperti pada program berikut ini.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="geographically-weighted-regression-gwr.html#cb144-1" aria-hidden="true"></a><span class="kw">library</span>(spgwr)</span></code></pre></div>
<pre><code>## Warning: package &#39;spgwr&#39; was built under R version 4.0.3</code></pre>
<pre><code>## NOTE: This package does not constitute approval of GWR
## as a method of spatial analysis; see example(gwr)</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="geographically-weighted-regression-gwr.html#cb147-1" aria-hidden="true"></a><span class="kw">coordinates</span>(datajawa)&lt;-<span class="kw">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>)</span>
<span id="cb147-2"><a href="geographically-weighted-regression-gwr.html#cb147-2" aria-hidden="true"></a>gwr20 &lt;-<span class="st"> </span><span class="kw">gwr</span>(Kemiskinan<span class="op">~</span>Rata.Rata.Lama.Sekolah,<span class="dt">data=</span>datajawa,<span class="dt">bandwidth=</span><span class="dv">20</span>)</span>
<span id="cb147-3"><a href="geographically-weighted-regression-gwr.html#cb147-3" aria-hidden="true"></a>gwr20</span></code></pre></div>
<pre><code>## Call:
## gwr(formula = Kemiskinan ~ Rata.Rata.Lama.Sekolah, data = datajawa, 
##     bandwidth = 20)
## Kernel function: gwr.Gauss 
## Fixed bandwidth: 20 
## Summary of GWR coefficient estimates at data points:
##                           Min. 1st Qu.  Median 3rd Qu.    Max.  Global
## X.Intercept.           24.6607 24.6971 24.7366 24.7620 24.8026 24.7340
## Rata.Rata.Lama.Sekolah -1.8708 -1.8673 -1.8651 -1.8617 -1.8585 -1.8657</code></pre>
<p>Kita dapat pula mengganti bandwidth sesuai dengan yang diinginkan. Selanjutnya kita akan bandingkan perbedaan akibat penentuan bandwidth yang berbeda-beda tersebut.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="geographically-weighted-regression-gwr.html#cb149-1" aria-hidden="true"></a>gwr3 &lt;-<span class="st"> </span><span class="kw">gwr</span>(Kemiskinan<span class="op">~</span>Rata.Rata.Lama.Sekolah,<span class="dt">data=</span>datajawa, <span class="dt">bandwidth=</span><span class="dv">3</span>)</span>
<span id="cb149-2"><a href="geographically-weighted-regression-gwr.html#cb149-2" aria-hidden="true"></a>gwr3</span></code></pre></div>
<pre><code>## Call:
## gwr(formula = Kemiskinan ~ Rata.Rata.Lama.Sekolah, data = datajawa, 
##     bandwidth = 3)
## Kernel function: gwr.Gauss 
## Fixed bandwidth: 3 
## Summary of GWR coefficient estimates at data points:
##                           Min. 1st Qu.  Median 3rd Qu.    Max.  Global
## X.Intercept.           21.8567 23.3823 24.6838 25.4191 26.4774 24.7340
## Rata.Rata.Lama.Sekolah -2.0218 -1.8937 -1.8219 -1.7275 -1.6145 -1.8657</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="geographically-weighted-regression-gwr.html#cb151-1" aria-hidden="true"></a>gwr2 &lt;-<span class="st"> </span><span class="kw">gwr</span>(Kemiskinan<span class="op">~</span>Rata.Rata.Lama.Sekolah,<span class="dt">data=</span>datajawa,<span class="dt">bandwidth=</span><span class="dv">2</span>)</span>
<span id="cb151-2"><a href="geographically-weighted-regression-gwr.html#cb151-2" aria-hidden="true"></a>gwr2</span></code></pre></div>
<pre><code>## Call:
## gwr(formula = Kemiskinan ~ Rata.Rata.Lama.Sekolah, data = datajawa, 
##     bandwidth = 2)
## Kernel function: gwr.Gauss 
## Fixed bandwidth: 2 
## Summary of GWR coefficient estimates at data points:
##                           Min. 1st Qu.  Median 3rd Qu.    Max.  Global
## X.Intercept.           19.5961 22.5941 24.3392 25.7094 27.7499 24.7340
## Rata.Rata.Lama.Sekolah -2.1862 -1.9058 -1.7441 -1.6570 -1.4305 -1.8657</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="geographically-weighted-regression-gwr.html#cb153-1" aria-hidden="true"></a>betabw20 &lt;-<span class="st"> </span>gwr20<span class="op">$</span>SDF<span class="op">$</span>Rata.Rata.Lama.Sekolah</span>
<span id="cb153-2"><a href="geographically-weighted-regression-gwr.html#cb153-2" aria-hidden="true"></a>betabw3 &lt;-<span class="st"> </span>gwr3<span class="op">$</span>SDF<span class="op">$</span>Rata.Rata.Lama.Sekolah</span>
<span id="cb153-3"><a href="geographically-weighted-regression-gwr.html#cb153-3" aria-hidden="true"></a>betabw2 &lt;-<span class="st"> </span>gwr2<span class="op">$</span>SDF<span class="op">$</span>Rata.Rata.Lama.Sekolah</span>
<span id="cb153-4"><a href="geographically-weighted-regression-gwr.html#cb153-4" aria-hidden="true"></a><span class="kw">boxplot</span>(betabw20, betabw3, betabw2, <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;bw=20&quot;</span>,<span class="st">&quot;bw=3&quot;</span>,<span class="st">&quot;bw=2&quot;</span>))</span></code></pre></div>
<p><img src="modul_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<p>Output di atas memperlihatkan bahwa bandwidth yang lebih besar cenderung menghasilkan penduga koefisien model dengan rentang nilai yang lebih sempit. Sebaliknya, jika bandwidth yang digunakan lebih kecil, maka penduga koefisien model cenderung memiliki rentang nilai yang lebih lebar.</p>
</div>
<div id="menentukan-bandwidth-optimal" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Menentukan Bandwidth Optimal</h2>
<p>Penentuan bandwidth yang optimal dapat ditentukan berdasarkan kriteria AIC atau CV. Selain itu, kita juga dapat memilih fungsi pembobot kernel yang ingin digunakan pada pemodelan GWR.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="geographically-weighted-regression-gwr.html#cb154-1" aria-hidden="true"></a>bw1 &lt;-<span class="st"> </span><span class="kw">gwr.sel</span>(Kemiskinan<span class="op">~</span>Rata.Rata.Lama.Sekolah,<span class="dt">data=</span>datajawa) <span class="co"># default method is CV</span></span></code></pre></div>
<pre><code>## Bandwidth: 3.450257 CV score: 946.7623 
## Bandwidth: 5.577059 CV score: 985.8033 
## Bandwidth: 2.135821 CV score: 877.1735 
## Bandwidth: 1.323454 CV score: 806.2682 
## Bandwidth: 0.8213845 CV score: 752.5299 
## Bandwidth: 0.5110882 CV score: 697.962 
## Bandwidth: 0.3193146 CV score: 699.4435 
## Bandwidth: 0.4257648 CV score: 686.988 
## Bandwidth: 0.4182171 CV score: 686.7128 
## Bandwidth: 0.4036248 CV score: 686.6801 
## Bandwidth: 0.3714212 CV score: 689.1402 
## Bandwidth: 0.4101954 CV score: 686.6098 
## Bandwidth: 0.4102361 CV score: 686.6098 
## Bandwidth: 0.4101547 CV score: 686.6098 
## Bandwidth: 0.4076605 CV score: 686.62 
## Bandwidth: 0.410114 CV score: 686.6098 
## Bandwidth: 0.4101547 CV score: 686.6098</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="geographically-weighted-regression-gwr.html#cb156-1" aria-hidden="true"></a>gwr01 &lt;-<span class="st"> </span><span class="kw">gwr</span>(Kemiskinan<span class="op">~</span>Rata.Rata.Lama.Sekolah,<span class="dt">data=</span>datajawa,<span class="dt">bandwidth=</span>bw1)</span>
<span id="cb156-2"><a href="geographically-weighted-regression-gwr.html#cb156-2" aria-hidden="true"></a></span>
<span id="cb156-3"><a href="geographically-weighted-regression-gwr.html#cb156-3" aria-hidden="true"></a>bw2 &lt;-<span class="st"> </span><span class="kw">gwr.sel</span>(Kemiskinan<span class="op">~</span>Rata.Rata.Lama.Sekolah,<span class="dt">data=</span>datajawa,<span class="dt">method=</span><span class="st">&quot;aic&quot;</span>)</span></code></pre></div>
<pre><code>## Bandwidth: 3.450257 AIC: 587.2351 
## Bandwidth: 5.577059 AIC: 591.8688 
## Bandwidth: 2.135821 AIC: 578.5693 
## Bandwidth: 1.323454 AIC: 569.3341 
## Bandwidth: 0.8213845 AIC: 562.5431 
## Bandwidth: 0.5110882 AIC: 558.7068 
## Bandwidth: 0.3193146 AIC: 575.363 
## Bandwidth: 0.6296109 AIC: 559.226 
## Bandwidth: 0.5177358 AIC: 558.6444 
## Bandwidth: 0.5525482 AIC: 558.5357 
## Bandwidth: 0.5819835 AIC: 558.6792 
## Bandwidth: 0.547683 AIC: 558.531 
## Bandwidth: 0.5465411 AIC: 558.5307 
## Bandwidth: 0.5462381 AIC: 558.5307 
## Bandwidth: 0.5462788 AIC: 558.5307 
## Bandwidth: 0.5461974 AIC: 558.5307 
## Bandwidth: 0.5462381 AIC: 558.5307</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="geographically-weighted-regression-gwr.html#cb158-1" aria-hidden="true"></a>gwr02 &lt;-<span class="st"> </span><span class="kw">gwr</span>(Kemiskinan<span class="op">~</span>Rata.Rata.Lama.Sekolah,<span class="dt">data=</span>datajawa,<span class="dt">bandwidth=</span>bw2)</span>
<span id="cb158-2"><a href="geographically-weighted-regression-gwr.html#cb158-2" aria-hidden="true"></a></span>
<span id="cb158-3"><a href="geographically-weighted-regression-gwr.html#cb158-3" aria-hidden="true"></a>bwbs1 &lt;-<span class="st"> </span><span class="kw">gwr.sel</span>(Kemiskinan<span class="op">~</span>Rata.Rata.Lama.Sekolah,<span class="dt">data=</span>datajawa,<span class="dt">gweight=</span>gwr.bisquare)</span></code></pre></div>
<pre><code>## Bandwidth: 3.450257 CV score: 816.2604 
## Bandwidth: 5.577059 CV score: 893.215 
## Bandwidth: 2.135821 CV score: 765.5706 
## Bandwidth: 1.323454 CV score: 696.4003 
## Bandwidth: 0.8213845 CV score: 722.8235 
## Bandwidth: 1.323495 CV score: 696.395 
## Bandwidth: 1.633776 CV score: 719.824 
## Bandwidth: 1.421531 CV score: 697.7054 
## Bandwidth: 1.36793 CV score: 694.5978 
## Bandwidth: 1.355794 CV score: 694.4734 
## Bandwidth: 1.358597 CV score: 694.4715 
## Bandwidth: 1.357479 CV score: 694.4699 
## Bandwidth: 1.357438 CV score: 694.4699 
## Bandwidth: 1.357397 CV score: 694.4699 
## Bandwidth: 1.357438 CV score: 694.4699</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="geographically-weighted-regression-gwr.html#cb160-1" aria-hidden="true"></a>gwr03 &lt;-<span class="st"> </span><span class="kw">gwr</span>(Kemiskinan<span class="op">~</span>Rata.Rata.Lama.Sekolah,<span class="dt">data=</span>datajawa,<span class="dt">gweight=</span>gwr.bisquare,</span>
<span id="cb160-2"><a href="geographically-weighted-regression-gwr.html#cb160-2" aria-hidden="true"></a>    <span class="dt">bandwidth=</span>bwbs1)</span>
<span id="cb160-3"><a href="geographically-weighted-regression-gwr.html#cb160-3" aria-hidden="true"></a></span>
<span id="cb160-4"><a href="geographically-weighted-regression-gwr.html#cb160-4" aria-hidden="true"></a>bwbs2 &lt;-<span class="st"> </span><span class="kw">gwr.sel</span>(Kemiskinan<span class="op">~</span>Rata.Rata.Lama.Sekolah,<span class="dt">data=</span>datajawa,</span>
<span id="cb160-5"><a href="geographically-weighted-regression-gwr.html#cb160-5" aria-hidden="true"></a>                 <span class="dt">gweight=</span>gwr.bisquare,<span class="dt">method=</span><span class="st">&quot;aic&quot;</span>)</span></code></pre></div>
<pre><code>## Bandwidth: 3.450257 AIC: 570.608 
## Bandwidth: 5.577059 AIC: 580.6548 
## Bandwidth: 2.135821 AIC: 564.1267 
## Bandwidth: 1.323454 AIC: 558.0575 
## Bandwidth: 0.8213845 AIC: 575.6082 
## Bandwidth: 1.633751 AIC: 558.9865 
## Bandwidth: 1.310745 AIC: 558.1617 
## Bandwidth: 1.435388 AIC: 557.6479 
## Bandwidth: 1.429706 AIC: 557.6416 
## Bandwidth: 1.420138 AIC: 557.6375 
## Bandwidth: 1.420321 AIC: 557.6375 
## Bandwidth: 1.420399 AIC: 557.6375 
## Bandwidth: 1.42044 AIC: 557.6375 
## Bandwidth: 1.420399 AIC: 557.6375</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="geographically-weighted-regression-gwr.html#cb162-1" aria-hidden="true"></a>gwr04 &lt;-<span class="st"> </span><span class="kw">gwr</span>(Kemiskinan<span class="op">~</span>Rata.Rata.Lama.Sekolah,<span class="dt">data=</span>datajawa,<span class="dt">gweight=</span>gwr.bisquare,</span>
<span id="cb162-2"><a href="geographically-weighted-regression-gwr.html#cb162-2" aria-hidden="true"></a>    <span class="dt">bandwidth=</span>bwbs2)</span></code></pre></div>
</div>
<div id="menentukan-model-terbaik" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Menentukan Model Terbaik</h2>
<p>Penentuan model terbaik dapat ditentukan berdasarkan beberapa kriteria tertentu. Fungsi <code>gwr</code> memungkinkan kita untuk mengevaluasi model berdasarkan AIC dan global quasi-<span class="math inline">\(R^2\)</span>, dengan terlebih dulu menambahkan argumen <code>hatmatrix=TRUE</code>.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="geographically-weighted-regression-gwr.html#cb163-1" aria-hidden="true"></a>gwr01 &lt;-<span class="st"> </span><span class="kw">gwr</span>(Kemiskinan<span class="op">~</span>Rata.Rata.Lama.Sekolah,<span class="dt">data=</span>datajawa,</span>
<span id="cb163-2"><a href="geographically-weighted-regression-gwr.html#cb163-2" aria-hidden="true"></a>             <span class="dt">hatmatrix=</span>T, <span class="dt">bandwidth=</span>bw1)</span>
<span id="cb163-3"><a href="geographically-weighted-regression-gwr.html#cb163-3" aria-hidden="true"></a>gwr01</span></code></pre></div>
<pre><code>## Call:
## gwr(formula = Kemiskinan ~ Rata.Rata.Lama.Sekolah, data = datajawa, 
##     bandwidth = bw1, hatmatrix = T)
## Kernel function: gwr.Gauss 
## Fixed bandwidth: 0.4101547 
## Summary of GWR coefficient estimates at data points:
##                            Min.  1st Qu.   Median  3rd Qu.     Max.  Global
## X.Intercept.           12.68449 18.33784 23.15972 26.20076 38.10046 24.7340
## Rata.Rata.Lama.Sekolah -4.20789 -2.05946 -1.55904 -1.22414 -0.46292 -1.8657
## Number of data points: 119 
## Effective number of parameters (residual: 2traceS - traceS&#39;S): 34.33575 
## Effective degrees of freedom (residual: 2traceS - traceS&#39;S): 84.66425 
## Sigma (residual: 2traceS - traceS&#39;S): 2.291766 
## Effective number of parameters (model: traceS): 25.10699 
## Effective degrees of freedom (model: traceS): 93.89301 
## Sigma (model: traceS): 2.176225 
## Sigma (ML): 1.933067 
## AICc (GWR p. 61, eq 2.33; p. 96, eq. 4.21): 562.1913 
## AIC (GWR p. 96, eq. 4.22): 519.682 
## Residual sum of squares: 444.673 
## Quasi-global R2: 0.7874434</code></pre>
<p>Fungsi <code>gwr</code> memberikan nilai AIC dengan tiga pendekatan, sehingga kita memperoleh AICc, AICb, dan AICh.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="geographically-weighted-regression-gwr.html#cb165-1" aria-hidden="true"></a>gwr01<span class="op">$</span>results<span class="op">$</span>AICc</span></code></pre></div>
<pre><code>## [1] 569.1585</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="geographically-weighted-regression-gwr.html#cb167-1" aria-hidden="true"></a>gwr01<span class="op">$</span>results<span class="op">$</span>AICb</span></code></pre></div>
<pre><code>## [1] 562.1913</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="geographically-weighted-regression-gwr.html#cb169-1" aria-hidden="true"></a>gwr01<span class="op">$</span>results<span class="op">$</span>AICh</span></code></pre></div>
<pre><code>## [1] 519.682</code></pre>
<p>Model terbaik adalah yang memiliki nilai AIC terkecil (bisa juga negatif) dan nilai global quasi-<span class="math inline">\(R^2\)</span> yang terbesar. Namun demikian, kriteria tersebut tidak memberikan informasi inferensia apapun terkait siginifikansi model GWR.</p>
<p>Beberapa pendekatan uji dapat dilakukan untuk menguji <span class="math inline">\(H_0\)</span> yang menyatakan bahwa model GWR tidak lebih baik daripada model OLS (regresi linier klasik), seperti yang dapat dilihat pada program-program berikut ini.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="geographically-weighted-regression-gwr.html#cb171-1" aria-hidden="true"></a><span class="kw">BFC02.gwr.test</span>(gwr01)</span></code></pre></div>
<pre><code>## 
##  Brunsdon, Fotheringham &amp; Charlton (2002, pp. 91-2) ANOVA
## 
## data:  gwr01
## F = 2.2103, df1 = 117.000, df2 = 84.664, p-value = 7.714e-05
## alternative hypothesis: greater
## sample estimates:
## SS OLS residuals SS GWR residuals 
##         982.8726         444.6730</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="geographically-weighted-regression-gwr.html#cb173-1" aria-hidden="true"></a><span class="kw">BFC99.gwr.test</span>(gwr01)</span></code></pre></div>
<pre><code>## 
##  Brunsdon, Fotheringham &amp; Charlton (1999) ANOVA
## 
## data:  gwr01
## F = 3.169, df1 = 87.18, df2 = 96.67, p-value = 2.996e-08
## alternative hypothesis: greater
## sample estimates:
## SS GWR improvement   SS GWR residuals 
##           538.1996           444.6730</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="geographically-weighted-regression-gwr.html#cb175-1" aria-hidden="true"></a><span class="kw">LMZ.F1GWR.test</span>(gwr01)</span></code></pre></div>
<pre><code>## 
##  Leung et al. (2000) F(1) test
## 
## data:  gwr01
## F = 0.62521, df1 = 96.67, df2 = 117.00, p-value = 0.00875
## alternative hypothesis: less
## sample estimates:
## SS OLS residuals SS GWR residuals 
##         982.8726         444.6730</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="geographically-weighted-regression-gwr.html#cb177-1" aria-hidden="true"></a><span class="kw">LMZ.F2GWR.test</span>(gwr01)</span></code></pre></div>
<pre><code>## 
##  Leung et al. (2000) F(2) test
## 
## data:  gwr01
## F = 1.9813, df1 = 47.916, df2 = 117.000, p-value = 0.001549
## alternative hypothesis: greater
## sample estimates:
##   SS OLS residuals SS GWR improvement 
##           982.8726           538.1996</code></pre>
<p>Berdasarkan output di atas, seluruh uji menunjukkan nilai <span class="math inline">\(p\)</span>-value yang lebih kecil daripada taraf nyata 0.05, artinya <span class="math inline">\(H_0\)</span> dapat ditolak, dan kita dapat menyimpulkan bahwa model GWR lebih baik daripada OLS, pada taraf nyata 5%.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="geographically-weighted-regression-gwr.html#cb179-1" aria-hidden="true"></a><span class="kw">LMZ.F3GWR.test</span>(gwr01)</span></code></pre></div>
<pre><code>## 
## Leung et al. (2000) F(3) test
## 
##                        F statistic Numerator d.f. Denominator d.f.     Pr(&gt;)
## (Intercept)                 2.6985        46.6539            96.67 1.988e-05
## Rata.Rata.Lama.Sekolah      2.1191        25.3140            96.67  0.004783
##                           
## (Intercept)            ***
## Rata.Rata.Lama.Sekolah ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="menginterpretasikan-hasil-pemodelan-gwr" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Menginterpretasikan Hasil Pemodelan GWR</h2>
<p>Koefisien model GWR bersifat lokal, sehingga nilai penduga koefisien akan diperoleh pada setiap titik pengamatan. Oleh karenanya, interpretasi model GWR seringkali dilakukan dengan membuat visualisasi dalam bentuk peta, baru kemudian menginterpretasikannya.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="geographically-weighted-regression-gwr.html#cb181-1" aria-hidden="true"></a><span class="kw">str</span>(gwr01<span class="op">$</span>SDF)</span></code></pre></div>
<pre><code>## Formal class &#39;SpatialPointsDataFrame&#39; [package &quot;sp&quot;] with 5 slots
##   ..@ data       :&#39;data.frame&#39;:  119 obs. of  12 variables:
##   .. ..$ sum.w                        : num [1:119] 7.49 14.3 13.86 13.78 13.72 ...
##   .. ..$ (Intercept)                  : num [1:119] 17.1 15.5 15.8 15.8 15.7 ...
##   .. ..$ Rata.Rata.Lama.Sekolah       : num [1:119] -1.21 -1.08 -1.11 -1.1 -1.09 ...
##   .. ..$ (Intercept)_se               : num [1:119] 3.52 2.76 2.79 2.83 2.85 ...
##   .. ..$ Rata.Rata.Lama.Sekolah_se    : num [1:119] 0.35 0.287 0.29 0.294 0.295 ...
##   .. ..$ gwr.e                        : num [1:119] 5.168 -0.198 0.191 0.206 -0.93 ...
##   .. ..$ pred                         : num [1:119] 6.81 3.03 2.95 3.38 4.32 ...
##   .. ..$ pred.se                      : num [1:119] 0.761 0.775 0.794 0.708 0.554 ...
##   .. ..$ localR2                      : num [1:119] 0.485 0.633 0.642 0.616 0.602 ...
##   .. ..$ (Intercept)_se_EDF           : num [1:119] 3.71 2.91 2.94 2.98 3 ...
##   .. ..$ Rata.Rata.Lama.Sekolah_se_EDF: num [1:119] 0.369 0.303 0.306 0.309 0.311 ...
##   .. ..$ pred.se                      : num [1:119] 0.801 0.816 0.836 0.746 0.583 ...
##   ..@ coords.nrs : num(0) 
##   ..@ coords     : num [1:119, 1:2] 107 107 107 107 107 ...
##   .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. ..$ : chr [1:119] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. .. ..$ : chr [1:2] &quot;Longitude&quot; &quot;Latitude&quot;
##   ..@ bbox       : num [1:2, 1:2] 105.69 -8.24 114.37 -5.8
##   .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. ..$ : chr [1:2] &quot;Longitude&quot; &quot;Latitude&quot;
##   .. .. ..$ : chr [1:2] &quot;min&quot; &quot;max&quot;
##   ..@ proj4string:Formal class &#39;CRS&#39; [package &quot;sp&quot;] with 1 slot
##   .. .. ..@ projargs: chr NA</code></pre>
<p>Beberapa nilai dapat diperoleh langsung dari output fungsi <code>gwr</code>, yaitu penduga koefisien, hasil prediksi model, serta <em>local</em>-<span class="math inline">\(R^2\)</span>. Selanjutnya, interpretasi dapat disesuaikan dengan konteks penelitian.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="geographically-weighted-regression-gwr.html#cb183-1" aria-hidden="true"></a>petajawa<span class="op">$</span>beta&lt;-gwr01<span class="op">$</span>SDF<span class="op">$</span>Rata.Rata.Lama.Sekolah</span>
<span id="cb183-2"><a href="geographically-weighted-regression-gwr.html#cb183-2" aria-hidden="true"></a>petajawa<span class="op">$</span>pred&lt;-gwr01<span class="op">$</span>SDF<span class="op">$</span>pred</span>
<span id="cb183-3"><a href="geographically-weighted-regression-gwr.html#cb183-3" aria-hidden="true"></a>petajawa<span class="op">$</span>localR2&lt;-gwr01<span class="op">$</span>SDF<span class="op">$</span>localR2</span>
<span id="cb183-4"><a href="geographically-weighted-regression-gwr.html#cb183-4" aria-hidden="true"></a></span>
<span id="cb183-5"><a href="geographically-weighted-regression-gwr.html#cb183-5" aria-hidden="true"></a><span class="kw">spplot</span>(petajawa, <span class="st">&quot;beta&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Penduga Koefisien Model GWR&quot;</span>)</span></code></pre></div>
<p><img src="modul_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="geographically-weighted-regression-gwr.html#cb184-1" aria-hidden="true"></a><span class="kw">spplot</span>(petajawa, <span class="st">&quot;pred&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Prediksi Kemiskinan&quot;</span>)</span></code></pre></div>
<p><img src="modul_files/figure-html/unnamed-chunk-75-2.png" width="672" /></p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="geographically-weighted-regression-gwr.html#cb185-1" aria-hidden="true"></a><span class="kw">spplot</span>(petajawa, <span class="st">&quot;localR2&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Local R-square&quot;</span>)</span></code></pre></div>
<p><img src="modul_files/figure-html/unnamed-chunk-75-3.png" width="672" /></p>
</div>
<div id="sumber-pustaka-2" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Sumber Pustaka</h2>
<p>Brazil, N. (n.d.). Geographically weighted regression. CRD 230: Spatial Methods in Community Research. <a href="https://crd230.github.io/gwr.html#ordinary_least_squares_regression" class="uri">https://crd230.github.io/gwr.html#ordinary_least_squares_regression</a></p>
<p>Brunsdon, C. 2015. Geographically Weighted Regression. <a href="https://rstudio-pubs-static.s3.amazonaws.com/176883_06a3fa1fc77444be85e94dcd97ba9a34.html" class="uri">https://rstudio-pubs-static.s3.amazonaws.com/176883_06a3fa1fc77444be85e94dcd97ba9a34.html</a></p>
<p>Dennett, A. (2014, November 17). An introduction to geographically weighted regression in R. <a href="https://rstudio-pubs-static.s3.amazonaws.com/44975_0342ec49f925426fa16ebcdc28210118.html" class="uri">https://rstudio-pubs-static.s3.amazonaws.com/44975_0342ec49f925426fa16ebcdc28210118.html</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pemodelan-dependensi-spasial.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="applications.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["modul.pdf", "modul.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
